<?xml version="1.0" encoding="UTF-8"?>
<!--
    stocks is client-server program to manage a household's food stock
    Copyright (c, valid_time_end asc) 2019  The stocks developers

    This file is part of the stocks program suite.

    stocks is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    stocks is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see https://www.gnu.org/licenses/.
-->
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd"
        context="production">

    <changeSet id="1" author="admin">
        <sql endDelimiter=";;">
            create index user_current
            on "User" ("ID" asc, valid_time_start asc, valid_time_end asc)
            where transaction_time_end = 'infinity';;

            create index user_device_current
            on "User_device" ("ID" asc, valid_time_start asc, valid_time_end asc)
            where transaction_time_end = 'infinity';;

            create index location_current
            on "Location" ("ID" asc, valid_time_start asc, valid_time_end asc)
            where transaction_time_end = 'infinity';;

            create index food_current
            on "Food" ("ID" asc, valid_time_start asc, valid_time_end asc)
            where transaction_time_end = 'infinity';;

            create index food_item_current
            on "Food_item" ("ID" asc, valid_time_start asc, valid_time_end asc)
            where transaction_time_end = 'infinity';;

            create index ean_number_current
            on "EAN_number" ("ID" asc, valid_time_start asc, valid_time_end asc)
            where transaction_time_end = 'infinity';;
        </sql>
        <rollback>
            drop index user_current;
            drop index user_device_current;
            drop index location_current;
            drop index food_current;
            drop index food_item_current;
            drop index ean_number_current;
        </rollback>
    </changeSet>
</databaseChangeLog>
